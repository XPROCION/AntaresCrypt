<html>
    <head>
        <link rel="icon" href="">
        <meta charset="utf-8">
        <title>SCM-RSA HYBRID</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
        <meta http-equiv="pragma" content="no-cache">
        <meta name="subject" content="">
        <meta name="description" content="">
        <Meta name="Classification" content="">
        <Meta name="rating" content="">
        <meta name="category" content="">
        <meta name="keywords" content="">
        <meta name="author" content="">
        <meta name="robots" content="index, follow">
        <meta http-equiv="content-type" content="text/html;UTF-8">
        <meta http-equiv="content-language" content="en">
        <meta http-equiv="revisit-after" content="">
        <meta http-equiv='cache-control' content='no-cache'>
        <meta http-equiv='expires' content='0'>
        <meta http-equiv='pragma' content='no-cache'>
        <link rel="shortcut icon" href="icon.jpg">
        <script src="js/crypto-js.min.js"></script>
        <script src="js/jsencrypt.min.js"></script>
        <script src="js/SilverCipherMini.js"></script>


<!--CSS-->
<style>
    .container {
    margin: 0 auto; /* divleri sayfada ortalamak iÃ§in */
    opacity:0.9;
  }
  body {
    background: white url("images/pexels-mnm-zameer-3308588.jpg") no-repeat center / cover;
    background-repeat: no-repeat; /* arkaplan resmini tekrarlama */
    background-attachment: fixed; /* arkaplan resmini sabit tut */
  }
    .a1 {
      white-space: break-word; /* divin iÃ§indeki elementlerin alt satÄ±ra geÃ§mesini engelle */
  }
  textarea {
 min-width: 300px;
 width: 100%; /* sabit bir geniÅŸlik */
 max-width: 644px; /* sabit bir geniÅŸlik */
 height: 150px;
 border: 2px solid #007bff;
 outline: none;
 padding: 10px;
 font-size: 18px;
 font-family: Roboto, sans-serif;
 resize: none;
 box-shadow: 0 4px 8px rgba(0,0,0,0.1);
 background: white;
 color: black;
 margin: 10px auto; /* divleri sayfada ortalamak iÃ§in */
 display: block; /* textarea'yÄ± blok element yap */
 
 }
 input {
 min-width: 300px;
 width: 100%; /* sabit bir geniÅŸlik */
 max-width: 640px; /* sabit bir geniÅŸlik */
 height: 50px; /* istediÄŸiniz yÃ¼kseklik */
 border: 2px solid #007bff;
 outline: none;
 padding: 10px;
 font-size: 18px;
 font-family: Roboto, sans-serif;
 resize: none;
 box-shadow: 0 4px 8px rgba(0,0,0,0.1);
 background: white;
 color: black;
 margin: 10px auto; /* divleri sayfada ortalamak iÃ§in */
 display: block; /* input'u blok element yap */
 }


 h1 {
 min-width: 100px;
 width:96%;
 max-width: 620px; /* sabit bir geniÅŸlik */
 font-size: 36px;
 font-family: Roboto, sans-serif;
 font-weight: bold;
 text-align: center;
 /*text-transform: uppercase;*/
 color: white;
 text-shadow: 0 0 10px rgba(0,0,0,0.5);
 background: linear-gradient(to right, #007bff, #00a8ff);
 padding: 10px;
 border: 2px solid #007bff;
 border-radius: 8px;
 box-shadow: 0 0 20px rgba(0,0,0,0.2);
 margin: 10px auto; /* h1'i sayfada ortalamak iÃ§in */
 display: block; /* h1'i blok element yap */
 }

 button {
 min-width: 100px;
 height: 80px;
 border: 2px solid #007bff;
 border-radius:8px;
 outline: none;
 padding: 10px;
 font-size: 22px;
 font-family: Roboto, sans-serif;
 box-shadow: 0 4px 8px rgba(0,0,0,0.1);
 background: linear-gradient(to right, #007bff, #00a8ff);
 color: white;
 margin: 0 auto; /* divleri sayfada ortalamak iÃ§in */
 display: inline-block; /* textarea'yÄ± blok element yap */
 transition: all 0.3s; /* dÃ¼zgÃ¼n bir geÃ§iÅŸ iÃ§in */
 }
 
 button:hover {
 transform: scale(1.05); /* Ã¼zerine gelince bÃ¼yÃ¼sÃ¼n */
 opacity: 0.9; /* biraz soluklaÅŸsÄ±n */
 }
 
 button:active {
 transform: scale(0.95); /* tÄ±klayÄ±nca kÃ¼Ã§Ã¼lsÃ¼n */
 box-shadow: inset 0 2px 4px rgba(0,0,0,0.2); /* iÃ§e doÄŸru bir gÃ¶lge olsun */
 }

p {
 min-width: 100px;
 width:96%;
 max-width: 620px; /* sabit bir geniÅŸlik */
 font-size: 36px;
 font-family: Arial, sans-serif;
 font-weight: bold;
 text-align: center;
 /*text-transform: uppercase;*/
 color: white;
 text-shadow: 0 0 10px rgba(0,0,0,0.5);
 padding: 10px;
 box-shadow: 0 0 20px rgba(0,0,0,0.2);
 display: block; /* p'yi blok element yap */
 margin:0 auto;
 }
/* dosya seÃ§me butonunu gizle */
input[type="file"]::file-selector-button {
  display: none;
}

/* dosya seÃ§me butonunun yerine istediÄŸiniz yazÄ±yÄ± ekle */
input[type="file"]::after {
  content: " AyarlarÄ± yÃ¼kle"; /* istediÄŸiniz yazÄ± */
  display: inline-block;
  padding: 8px 12px;
  cursor: pointer;
  border: 1px solid #ddd;
  border-radius: 4px;
}
/* a elementinin stilini belirle */
a {
  /* metin rengini beyaz yap */
  color: white;
  /* arka plan rengini koyu gri yap */
  background-color: #333;
  /* kenar boÅŸluklarÄ±nÄ± ayarla */
  padding: 8px 12px;
  /* kenar yuvarlaklÄ±ÄŸÄ±nÄ± ayarla */
  border-radius: 4px;
  /* metin dekorasyonunu kaldÄ±r */
  text-decoration: none;
}

/* a elementinin Ã¼zerine gelindiÄŸinde stilini belirle */
a:hover {
  /* arka plan rengini aÃ§Ä±k gri yap */
  background-color: #555;
}
/* seÃ§im elementinin kenarlÄ±ÄŸÄ± ve arka plan rengi */
select {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  min-width: 300px;
  width: 100%;
  max-width: 644px;
  height: 50px;
  border: 2px solid #007bff; /* mavi kenarlÄ±k */
  font-size: 24px;
  background-color: #eee; /* gri arka plan */
  position: relative; /* pozisyonu gÃ¶reli yap */
}

/* seÃ§im elementinin Ã¼zerine geldiÄŸinde veya tÄ±kladÄ±ÄŸÄ±nda arka plan rengi ve kenarlÄ±ÄŸÄ± */
select:hover {
  background-color: #ddd; /* aÃ§Ä±k gri arka plan */
}

select:focus {
  border-color: #004080; /* koyu mavi kenarlÄ±k */
}

/* seÃ§im elementinin saÄŸ tarafÄ±na bir ok simgesi eklemek */
select::after {
  content: "â–¼"; /* ok karakteri */
  position: absolute; /* pozisyonu mutlak yap */
  right: 10px; /* saÄŸa hizala */
  top: 50%; /* ortala */
  transform: translateY(-50%); /* ortala */
}

/* seÃ§eneklerin yazÄ± tipi, yazÄ± boyutu ve yazÄ± rengi */
option {
  font-family: Roboto, sans-serif; /* Roboto yazÄ± tipi */
  font-size: 18px; /* 18px yazÄ± boyutu */
  color: #000; /* siyah yazÄ± rengi */
}

/* seÃ§ilen seÃ§eneÄŸin arka plan rengi ve yazÄ± rengi */
option:checked {
  background-color: #0f0; /* yeÅŸil arka plan */
  color: #fff; /* beyaz yazÄ± rengi */
}

</style>
<!--CSS END-->


    </head>
    <body>
        <div class="a1">
            
          <h1 class="container" style="border:none!important;box-shadow:none!important;background:transparent!important;">SCM-RSA Hybrid Encryption</h1>
          <input type="password" id="ortak" class="container" style="border-radius: 15px;margin-bottom:10px;" placeholder="ğŸ”‘ Symmetric Key" autocomplete="off">
          <div style="text-align: center;overflow: none!important;">
            <select id="rsamode" name="rsamode" size="1" style="min-width: 300px;width: 100%;max-width: 644px; border:2px solid #007bff;font-size:24px;border-radius: 15px;">
            <option value="1" style="color:gray;">Hybrid SIGN-MIX (Slow)</option>
            <option value="2" selected style="color:green;">Hybrid SIGN-FLEX-DUAL (Fast)</option>
            <option value="3" style="color:gray;">Symmetric SCM-AES (Fast)</option>
            </select>
          </div>
          <br>
          <h1 class="container" style="border-radius:0;border-top-left-radius: 15px;border-top-right-radius: 15px;">Decrypt / Verify</h1>
          <textarea spellcheck="false" id="arkadasinin_sifreli_mesaji" class="container" style="border-radius:0!important;" autocomplete="off" placeholder="Encrypted Message..."></textarea>
          <div style="text-align: center;"><button type="button" style="border-radius:0;border-bottom-left-radius: 15px!important;border-bottom-right-radius: 15px!important;margin-bottom:10px;min-width: 300px;width: 100%;max-width: 644px;font-size:22px;" onclick="friend_decrypt_encrypted_message()">ğŸ”“ Read the message</button></div>
          <div style="text-align: center;">
            <div style="display: inline-block;">
            <button onclick="kopyala0()" type="button" style="
             margin-bottom:10px;
             ">â†‘â†‘ Copy â†‘â†‘</button>
            <button onclick="yapistir0()" type="button" style="
            margin-bottom:10px;
            ">â†‘â†‘ Paste â†‘â†‘</button>
            <button onclick="clear0()" type="button" style="
             margin-bottom:10px;
             ">â†‘â†‘ Clear â†‘â†‘</button>
             <button type="button" style="
             margin-bottom:10px;
             "><input type="file" id="encryptfile" style="display:none;"><label for="encryptfile">â†‘â†‘ Text File â†‘â†‘</label></button>
            </div>
          </div>
          <h1 class="container" style="border-radius:0;border-top-left-radius: 15px;border-top-right-radius: 15px;">Encrypt / Sign</h1>
          <textarea spellcheck="false" id="sifrelenecek_rsa_mesaji" class="container" style="border-radius:0!important;" autocomplete="off" placeholder="Message to Encrypt..."></textarea>
          <div style="text-align: center;"><button type="button" style="border-radius:0;border-bottom-left-radius: 15px!important;border-bottom-right-radius: 15px!important;margin-bottom:10px;min-width: 300px;width: 100%;max-width: 644px;font-size:22px;" onclick="friend_sent_encrypted_message()">ğŸ”’ Encrypt Message</button></div>
          <div style="text-align: center;">
            <div style="display: inline-block;">
            <button onclick="kopyala1()" type="button" style="
             margin-bottom:10px;
             ">â†‘â†‘ Copy â†‘â†‘</button>
            <button onclick="yapistir1()" type="button" style="
            margin-bottom:10px;
            ">â†‘â†‘ Paste â†‘â†‘</button>
            <button onclick="clear1()" type="button" style="
             margin-bottom:10px;
             ">â†‘â†‘ Clear â†‘â†‘</button>
             <button type="button" style="
             margin-bottom:10px;
             "><input type="file" id="decryptfile" style="display:none;"><label for="decryptfile">â†‘â†‘ Text File â†‘â†‘</label></button>
            </div>
          </div>
          <h1 class="container" style="border:none!important;box-shadow:none!important;background:transparent!important;">Load Config File</h1>
          <input type="password" id="config_shield" class="container" style="border-radius: 15px;margin-bottom:10px;" placeholder="ğŸ”‘ Config File Protection Key" autocomplete="off">
          <div style="text-align: center;">
          <button onclick="conf_download()" type="button" style="margin-bottom:10px;padding-left:10px;padding-right: 10px;">Download Config</button>
          <button type="button" style="margin-bottom:10px;padding-left:10px;padding-right: 10px;"><input type="file" id="dosya" accept="application/json" style="display:none;"><label for="dosya">Load Config</label></button>
          </div>
          <h1 class="container" style="border-top-left-radius: 15px;border-top-right-radius: 15px;margin-top:5px!important;">Friend's public key</h1>
          <textarea spellcheck="false" style="border-bottom-left-radius: 15px;border-bottom-right-radius: 15px;margin-bottom:10px;" class="container" id="target_public_key" autocomplete="off" placeholder="ğŸ”‘ ArkadaÅŸÄ±nÄ±n Public Key'i..."></textarea>
          <div style="text-align: center;">
            <div style="display: inline-block;">
            <button onclick="kopyala2()" type="button" style="
             margin-bottom:10px;font-size:22px;
             ">â†‘â†‘ Copy â†‘â†‘</button>
            <button onclick="yapistir2()" type="button" style="
             margin-bottom:10px;font-size:22px;
             ">â†‘â†‘ Paste â†‘â†‘</button>
            <button onclick="clear2()" type="button" style="
               margin-bottom:10px;font-size:22px;
            ">â†‘â†‘ Clear â†‘â†‘</button>
            <button onclick="inject2()" type="button" style="
             margin-bottom:10px;font-size:22px;
             ">â†‘â†‘ INJECT-PEM â†‘â†‘</button>
            </div>
          </div>
          <h1 style="border-top-left-radius: 15px;border-top-right-radius: 15px;margin-top:5px!important;" class="container">Your public key</h1>
          <textarea id="bizim_public_keyimiz" spellcheck="false" style="border-bottom-left-radius: 15px;border-bottom-right-radius: 15px;margin-bottom:10px;" class="container" autocomplete="off" placeholder="ğŸ”‘ Your Public Key..."></textarea>
          <div style="text-align: center;">
            <div style="display: inline-block;">
            <button onclick="kopyala3()" type="button" style="
             margin-bottom:10px;font-size:22px;
             ">â†‘â†‘ Copy â†‘â†‘</button>
            <button onclick="yapistir3()" type="button" style="
            margin-bottom:10px;font-size:22px;
            ">â†‘â†‘ Paste â†‘â†‘</button>
            <button onclick="clear3()" type="button" style="
            margin-bottom:10px;font-size:22px;
            ">â†‘â†‘ Clear â†‘â†‘</button>
            <button onclick="inject3()" type="button" style="
             margin-bottom:10px;font-size:22px;
             ">â†‘â†‘ INJECT-PEM â†‘â†‘</button>
            </div>
          </div>
          <h1 style="border-top-left-radius: 15px;border-top-right-radius: 15px;margin-top:5px!important;" class="container">Your private key</h1>
          <textarea id="bizim_private_keyimiz" spellcheck="false" class="container" style="border-bottom-left-radius: 15px;border-bottom-right-radius: 15px;margin-bottom:10px;" autocomplete="off" placeholder="ğŸ”‘ Your Private Key..."></textarea>
          <div style="text-align: center;">
            <div style="display: inline-block;">
            <button onclick="kopyala4()" type="button" style="
             margin-bottom:10px;font-size:22px;
             ">â†‘â†‘ Copy â†‘â†‘</button>
            <button onclick="yapistir4()" type="button" style="
            margin-bottom:10px;font-size:22px;
            ">â†‘â†‘ Paste â†‘â†‘</button>
             <button onclick="clear4()" type="button" style="
             margin-bottom:10px;font-size:22px;
            ">â†‘â†‘ Clear â†‘â†‘</button>
            <button onclick="inject4()" type="button" style="
             margin-bottom:10px;font-size:22px;
             ">â†‘â†‘ INJECT-PEM â†‘â†‘</button>
            </div>
          </div>
          <br>
          <h1 class="container" style="border:none!important;box-shadow:none!important;background:transparent!important;">Change password</h1>
          <input type="password" id="passchange" class="container" style="border-radius: 15px;margin-bottom:10px;" placeholder="ğŸ”‘ New Symmetric Key" autocomplete="off">
          <div style="text-align: center;">
          <button onclick="passchange()" type="button" style="width: 96% !important;max-width: 620px;" >Change</button>
          </div>
          <br>
          <h1 class="container" style="border:none!important;box-shadow:none!important;background:transparent!important;">RSA Key Generator</h1>
          <div style="text-align: center;">
          <button onclick="key_gen_main(2048)" type="button" style="margin-bottom:10px;width: 96% !important;max-width: 620px;">2048 Bit / 2s</button>
          </div>
          <div style="text-align: center;">
          <button onclick="key_gen_main(3072)" type="button" style="margin-bottom:10px;width: 96% !important;max-width: 620px;">3072 Bit / 13s</button>
          </div>
          <div style="text-align: center;">
          <button onclick="key_gen_main(4096)" type="button" style="margin-bottom:10px;width: 96% !important;max-width: 620px;">4096 Bit / 45s</button>
          </div>
          <div style="text-align: center;">
          <button onclick="key_gen_main(8192)" type="button" style="margin-bottom:10px;width: 96% !important;max-width: 620px;">8192 Bit / 3h</button>
          </div>
          <div style="text-align: center;">
          <button onclick="key_gen_main(16384)" type="button" style="width: 96% !important;max-width: 620px;">16384 Bit / 1d</button>
          </div>
          <br><br>
          <h1 class="container" style="border:none!important;box-shadow:none!important;background:transparent!important;">Information</h1>
          <p style="margin-bottom:10px;">It is absolutely javascript based only. Node does not use js and php script. It works on your local browser.</p>
          <h1 class="container" style="border:none!important;box-shadow:none!important;background:transparent!important;">Encryption</h1>
          <p style="margin-top:10px;margin-bottom:10px;">Uses SCM as symmetric encryption.</p>
          <p style="margin-bottom:10px;">Uses rsa as asymetric encryption.</p>
          <p>Uses rsa as a signing. For security, signature is sent in json format in encrypted data.</p>
          <h1 class="container" style="border:none!important;box-shadow:none!important;background:transparent!important;">The project is open source.</h1>
          <h1 class="container" style="border:none!important;box-shadow:none!important;background:transparent!important;"><a href="https://github.com/h6465617468/SilverCipher/blob/main/index.html">Source Codes</a></h1>
          <br><br>



<!--SCRIPTS-->
<script>
function changeText_JS(value) {
  // seÃ§im elementini bul
  var select = document.getElementById("rsamode");
  // seÃ§im elementinin seÃ§ili seÃ§eneÄŸini bul
  var selectedOption = select.options[select.selectedIndex];
  // seÃ§im elementinin tÃ¼m seÃ§eneklerini dÃ¶ngÃ¼ye sok
  for (var i = 0; i < select.options.length; i++) {
    // seÃ§eneÄŸin deÄŸeri ve metnini al
    var option = select.options[i];
    var optionValue = option.value;
    var optionText = option.text;
    // deÄŸer ve metni eÅŸleÅŸirse metni deÄŸiÅŸtir
    if (optionValue == value) {
      select.value = value;
      select.text = optionText;
    }
  }
}



var select = document.getElementById("rsamode");
function kopyala4() {
  var textarea = document.getElementById("bizim_private_keyimiz");
  textarea.select(); // metni seÃ§
  document.execCommand("copy"); // panoya kopyala
}
function yapistir4(){var t=document.getElementById("bizim_private_keyimiz");t&&navigator.clipboard.readText().then(function(n){t.value=n}).catch(function(n){console.error(n)})}
function kopyala3() {
  var textarea = document.getElementById("bizim_public_keyimiz");
  textarea.select(); // metni seÃ§
  document.execCommand("copy"); // panoya kopyala
}
function yapistir3(){var t=document.getElementById("bizim_public_keyimiz");t&&navigator.clipboard.readText().then(function(n){t.value=n}).catch(function(n){console.error(n)})}
function clear4() {
  var textarea = document.getElementById("bizim_private_keyimiz");
  textarea.value = ""; // metni seÃ§
}
function inject4() {
  var ortak_anahtar = document.getElementById("ortak").value;
        if(ortak_anahtar == "" || ortak_anahtar == null){
            alert("Symmetric Key Required");
            return;
        }
  var cipher = new SilverCipherMini(ortak_anahtar);
  var textarea = document.getElementById("bizim_private_keyimiz");
  var bizim_private_keyimiz = textarea.value.trim();
  if (bizim_private_keyimiz.startsWith("-----BEGIN RSA PRIVATE KEY-----")) {
    textarea.value = cipher.Encrypt(bizim_private_keyimiz);
  } else {
    alert("The key is not in PEM format");
  }
}
function clear3() {
  var textarea = document.getElementById("bizim_public_keyimiz");
  textarea.value = ""; // metni seÃ§
}
function inject3() {
  var ortak_anahtar = document.getElementById("ortak").value;
        if(ortak_anahtar == "" || ortak_anahtar == null){
            alert("Symmetric Key Required");
            return;
        }
  var cipher = new SilverCipherMini(ortak_anahtar);
  var textarea = document.getElementById("bizim_public_keyimiz");
  var bizim_public_keyimiz = textarea.value.trim();
  if (bizim_public_keyimiz.startsWith("-----BEGIN PUBLIC KEY-----")) {
    textarea.value = cipher.Encrypt(bizim_public_keyimiz);
  } else {
    alert("The key is not in PEM format");
  }
}
function kopyala2() {
  var textarea = document.getElementById("target_public_key");
  textarea.select(); // metni seÃ§
  document.execCommand("copy"); // panoya kopyala
}
function yapistir2(){var t=document.getElementById("target_public_key");t&&navigator.clipboard.readText().then(function(n){t.value=n}).catch(function(n){console.error(n)})}
function clear2() {
  var textarea = document.getElementById("target_public_key");
  textarea.value = ""; // metni seÃ§
}
function inject2() {
  var ortak_anahtar = document.getElementById("ortak").value;
        if(ortak_anahtar == "" || ortak_anahtar == null){
            alert("Symmetric Key Required");
            return;
        }
  var cipher = new SilverCipherMini(ortak_anahtar);
  var textarea = document.getElementById("target_public_key");
  var target_public_key = textarea.value.trim();
  if (target_public_key.startsWith("-----BEGIN PUBLIC KEY-----")) {
    textarea.value = cipher.Encrypt(target_public_key);
  } else {
    alert("The key is not in PEM format");
  }
}
function kopyala1() {
  var textarea = document.getElementById("sifrelenecek_rsa_mesaji");
  textarea.select(); // metni seÃ§
  document.execCommand("copy"); // panoya kopyala
}
function yapistir1(){var t=document.getElementById("sifrelenecek_rsa_mesaji");t&&navigator.clipboard.readText().then(function(n){t.value=n}).catch(function(n){console.error(n)})}
function clear1() {
  var textarea = document.getElementById("sifrelenecek_rsa_mesaji");
  textarea.value = ""; // metni seÃ§
}
function kopyala0() {
  var textarea = document.getElementById("arkadasinin_sifreli_mesaji");
  textarea.select(); // metni seÃ§
  document.execCommand("copy"); // panoya kopyala
}
function yapistir0(){var t=document.getElementById("arkadasinin_sifreli_mesaji");t&&navigator.clipboard.readText().then(function(n){t.value=n}).catch(function(n){console.error(n)})}
function clear0() {
  var textarea = document.getElementById("arkadasinin_sifreli_mesaji");
  textarea.value = ""; // metni seÃ§
}
      var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="";var n,r,i,s,o,u,a;var f=0;e=Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t="";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=Base64._utf8_decode(t);return t},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t},_utf8_decode:function(e){var t="";var n=0;var r=c1=c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}}

function str_splitx(string, splitLength) {
  if (splitLength === null) {
    splitLength = 1
  }
  if (string === null || splitLength < 1) {
    return false
  }
  string += ''
  const chunks = []
  let pos = 0
  const len = string.length
  while (pos < len) {
    chunks.push(string.slice(pos, pos += splitLength))
  }
  return chunks
}

function key_gen_main(sizex){
    var ortak_anahtar = document.getElementById("ortak").value;
        if(ortak_anahtar == "" || ortak_anahtar == null){
            alert("Symmetric Key Required");
            return;
        }
    var cipher = new SilverCipherMini(ortak_anahtar);
    var crypt9 = new JSEncrypt({default_key_size: sizex});
    new Promise((resolve)=>{
    setTimeout(resolve, 100);
    }).then( ()=>{
        crypt9.getKey();
    }).finally(() => {
      var publicasdasdas=crypt9.getPublicKey();
var privateKeyElement = document.getElementById("bizim_private_keyimiz");
privateKeyElement.innerHTML = cipher.Encrypt(crypt9.getPrivateKey());

var publicKeyElement = document.getElementById("bizim_public_keyimiz");
publicKeyElement.innerHTML = cipher.Encrypt(publicasdasdas);

    });
}
function encrypt_1(key, iv, plaintext) {
    const keyHex = CryptoJS.enc.Hex.parse(key);
    const ivHex = CryptoJS.enc.Hex.parse(iv);
    const encrypted = CryptoJS.AES.encrypt(plaintext, keyHex, {
      iv: ivHex,
      mode: CryptoJS.mode.CBC,
      padding: CryptoJS.pad.Pkcs7,
    });
    return encrypted.ciphertext.toString(CryptoJS.enc.Base64);
}

function decrypt_1(key, iv, ciphertext) {
    const keyHex = CryptoJS.enc.Hex.parse(key);
    const ivHex = CryptoJS.enc.Hex.parse(iv);
    const decrypted = CryptoJS.AES.decrypt({
      ciphertext: CryptoJS.enc.Base64.parse(ciphertext),
    }, keyHex, {
      iv: ivHex,
      mode: CryptoJS.mode.CBC,
      padding: CryptoJS.pad.Pkcs7,
    });
    return decrypted.toString(CryptoJS.enc.Utf8);
}
function encryptData(cache_x_RSA,key,myprivate){
    var cache_signp="";
      var cache_109=str_splitx(cache_x_RSA,128);
      var crypted0193=[];
      var asjdasjdajs=[];
      cache_109.forEach(function(data5) {
    var crypt123123123 = new JSEncrypt();
    crypt123123123.setPrivateKey(myprivate.trim());
    var fsdkjf34o2it2=Base64.encode(data5);
    cache_signp=crypt123123123.sign(fsdkjf34o2it2, CryptoJS.SHA256, "sha256");
    asjdasjdajs.push({"text":fsdkjf34o2it2,"sign":cache_signp});
    delete fsdkjf34o2it2;
        });
            var cache_123123=JSON.stringify(asjdasjdajs);
                var cryptedasdasdas1111=[];
                cache_12312asdasdas3=str_splitx(cache_123123,128);
                cache_12312asdasdas3.forEach(function(data10, index1) {
                  var crypt = new JSEncrypt();
                  crypt.setPublicKey(key.trim());
                  cryptedasdasdas1111.push(Base64.encode(crypt.encrypt(data10)));
                });
                crypted0193.push(JSON.stringify(cryptedasdasdas1111));
      delete cache_109;
           return JSON.stringify(crypted0193);
          }
          function decryptData(encryptedData, myprivate, key) {
            var decryptedData = "";
            try {
            var crypted0193 = JSON.parse(encryptedData);
            var cryptedasdasdas1111 = JSON.parse(crypted0193[0]);
            var asjdasjdajs = [];
            var asdasdasd="";
            cryptedasdasdas1111.forEach(function(data10, index1) {
            var crypt = new JSEncrypt();
            crypt.setPrivateKey(myprivate.trim());
            var decryptedData1 = crypt.decrypt(Base64.decode(data10));
            asdasdasd=asdasdasd+decryptedData1;
            delete decryptedData1;
            });
            asjdasjdajs = asjdasjdajs.concat(JSON.parse(asdasdasd));
            asjdasjdajs.forEach(function(data5) {
            var crypt123123123 = new JSEncrypt();
            crypt123123123.setPublicKey(key.trim());
            var signature = data5.sign;
            var plaintext = data5.text;
            var isSignatureValid = crypt123123123.verify(plaintext, signature, CryptoJS.SHA256);
            if (isSignatureValid) {
            decryptedData += Base64.decode(plaintext);
            } else {
              return "";
            /*throw new Error("Invalid signature!");*/
            }
            delete signature, plaintext;
            });
            } catch (e) {
              return "";
            /*throw new Error("Decryption failed! " + e.message);*/
            }
            return decryptedData;
            }
  function encryptData_FLEXMODE(cache_x_RSA,key,myprivate)
  {
    var cache_signp="";
    var sava1sf = "";
    try {
      var crypt123123123 = new JSEncrypt();
    crypt123123123.setPrivateKey(myprivate.trim());
    cache_signp=crypt123123123.sign(cache_x_RSA, CryptoJS.SHA256, "sha256");
    var cache_109=str_splitx(cache_x_RSA,128);
    // dÃ¶ngÃ¼deki son elemanÄ±n indeksini bul
    var lastIndex = cache_109.length - 1;
    cache_109.forEach(function(data5, index) {
      var crypt = new JSEncrypt();
      crypt.setPublicKey(key.trim());
      var hjd = Base64.encode(crypt.encrypt(data5));
      // eÄŸer son eleman ise # eklemeyi atla
      if (index == lastIndex) {
        sava1sf=sava1sf+hjd;
      } else {
        sava1sf=sava1sf+hjd+"#";
      }
    });

    } catch (e) {return "";}
    return sava1sf+"#"+cache_signp;
  }
          function decryptData_FLEXMODE(encryptedData, myprivate, key) {
            var asdasdasd="";
            try {
// encryptedData deÄŸerini # ile bÃ¶l
var parts = encryptedData.split("#");
// son parÃ§ayÄ± signature deÄŸerine ata
var signature = parts.pop();
            
parts.forEach(function(data10) {
            var crypt = new JSEncrypt();
            crypt.setPrivateKey(myprivate.trim());
            var decryptedData1 = crypt.decrypt(Base64.decode(data10));
            asdasdasd=asdasdasd+decryptedData1;
            delete decryptedData1;
            });
            var crypt123123123 = new JSEncrypt();
            crypt123123123.setPublicKey(key.trim());
            var isSignatureValid = crypt123123123.verify(asdasdasd, signature, CryptoJS.SHA256);
            if (isSignatureValid) {
            } else {
           return "";
            }
          } catch (e) {return "";}

            return asdasdasd;
            }

    function friend_sent_encrypted_message() {
        var ortak_anahtar = document.getElementById("ortak").value;
        if(ortak_anahtar == "" || ortak_anahtar == null){
            alert("Symmetric Key Required");
            return;
        }
        var cipher = new SilverCipherMini(ortak_anahtar);
        var arkadasinin_sifreli_mesaji = document.getElementById("arkadasinin_sifreli_mesaji").value;
        var sifrelenecek_mesaj = document.getElementById("sifrelenecek_rsa_mesaji").value;
        var target_public_key = cipher.Decrypt(document.getElementById("target_public_key").value.trim());
        var bizim_public_keyimiz = cipher.Decrypt(document.getElementById("bizim_public_keyimiz").value.trim());
        var bizim_private_keyimiz = cipher.Decrypt(document.getElementById("bizim_private_keyimiz").value.trim());
        var asdas = document.getElementById("sifrelenecek_rsa_mesaji");
        var encrypted="";
        var e = document.getElementById("rsamode"); // seÃ§im elementini bul
        var text = e.value; // seÃ§ilen seÃ§eneÄŸin metnini al

        try {
        if(text=="1"){
          encrypted = encryptData(sifrelenecek_mesaj,target_public_key,bizim_private_keyimiz);
        }else if(text=="2"){
          encrypted = encryptData_FLEXMODE(sifrelenecek_mesaj,target_public_key,bizim_private_keyimiz);
        }else if(text=="3"){
          var key = CryptoJS.SHA256(ortak_anahtar).toString(CryptoJS.enc.Hex);
          var iv = CryptoJS.MD5(ortak_anahtar).toString(CryptoJS.enc.Hex);
          encrypted = encrypt_1(key,iv,sifrelenecek_mesaj);
        }
        encrypted = cipher.Encrypt(encrypted);
        } catch (err) {
        // Error yakalama kodu
        alert("Error");
        }
        asdas.value = encrypted;
    }

    function friend_decrypt_encrypted_message() {
        var ortak_anahtar = document.getElementById("ortak").value;
        if(ortak_anahtar == "" || ortak_anahtar == null){
            alert("Symmetric Key Required");
            return;
        }
        var cipher = new SilverCipherMini(ortak_anahtar);
        var arkadasinin_sifreli_mesaji = document.getElementById("arkadasinin_sifreli_mesaji").value.trim();
        var sifrelenecek_mesaj = document.getElementById("sifrelenecek_rsa_mesaji").value;
        var target_public_key = cipher.Decrypt(document.getElementById("target_public_key").value.trim());
        var bizim_public_keyimiz = cipher.Decrypt(document.getElementById("bizim_public_keyimiz").value.trim());
        var bizim_private_keyimiz = cipher.Decrypt(document.getElementById("bizim_private_keyimiz").value.trim());
        var asdas = document.getElementById("arkadasinin_sifreli_mesaji");
        var encrypted="";
        var e = document.getElementById("rsamode"); // seÃ§im elementini bul
        var text = e.value; // seÃ§ilen seÃ§eneÄŸin metnini al
        try {
        arkadasinin_sifreli_mesaji = cipher.Decrypt(arkadasinin_sifreli_mesaji);
        if(text=="1"){
          encrypted = decryptData(arkadasinin_sifreli_mesaji,bizim_private_keyimiz,target_public_key);
        }else if(text=="2"){
          encrypted = decryptData_FLEXMODE(arkadasinin_sifreli_mesaji,bizim_private_keyimiz,target_public_key);
        }else if(text=="3"){
          var key = CryptoJS.SHA256(ortak_anahtar).toString(CryptoJS.enc.Hex);
          var iv = CryptoJS.MD5(ortak_anahtar).toString(CryptoJS.enc.Hex);
          encrypted = decrypt_1(key,iv,arkadasinin_sifreli_mesaji);
        }
        } catch (err) {
        // Error yakalama kodu
        alert("Error");
        }
        asdas.value = encrypted;
    }
function conf_download(){
var config_shield = document.getElementById("config_shield").value;
var ortak_anahtar = document.getElementById("ortak").value;
if(config_shield == "" || config_shield == null){
    alert("Config File Protection Key Required");
    return;
}
    // ayarlar.json dosyasÄ±nÄ±n iÃ§eriÄŸi
var target_public_key = document.getElementById("target_public_key").value.trim();
var bizim_public_keyimiz = document.getElementById("bizim_public_keyimiz").value.trim();
var bizim_private_keyimiz = document.getElementById("bizim_private_keyimiz").value.trim();
var key = CryptoJS.SHA256(config_shield).toString(CryptoJS.enc.Hex);
var iv = CryptoJS.MD5(config_shield).toString(CryptoJS.enc.Hex);
var e = document.getElementById("rsamode"); // seÃ§im elementini bul
var rsa_mode = e.value; // seÃ§ilen seÃ§eneÄŸin metnini al
var ayarlar = {
  "targetpublic": encrypt_1(key,iv,target_public_key),
  "mypublic": encrypt_1(key,iv,bizim_public_keyimiz),
  "myprivate": encrypt_1(key,iv,bizim_private_keyimiz),
  "ortak_anahtar": encrypt_1(key,iv,ortak_anahtar),
  "rsa_mode": encrypt_1(key,iv,rsa_mode)
};

// ayarlar.json dosyasÄ±nÄ± oluÅŸturmak iÃ§in
var blob = new Blob([JSON.stringify(ayarlar)], {type: "application/json"});

// ayarlar.json dosyasÄ±nÄ±n URL'sini oluÅŸturmak iÃ§in
var url = URL.createObjectURL(blob);

// ayarlar.json dosyasÄ±nÄ± indirmek iÃ§in
var a = document.createElement("a");
a.href = url;
a.download = CryptoJS.SHA256(target_public_key+bizim_public_keyimiz+bizim_private_keyimiz).toString(CryptoJS.enc.Hex) + ".json";
document.body.appendChild(a);
a.click();
document.body.removeChild(a);
}

// seÃ§ilen dosyayÄ± okumak iÃ§in
var dosya = document.getElementById("dosya");
dosya.addEventListener("change", function() {
var config_shield = document.getElementById("config_shield").value;
if(config_shield == "" || config_shield == null){
    alert("Config File Protection Key Required");
    dosya.value = "";
    return;
}
  // seÃ§ilen ilk dosyayÄ± al
  var secilenDosya = this.files[0];
  // FileReader nesnesi oluÅŸtur
  var reader = new FileReader();
  // dosyayÄ± okuma iÅŸlemi tamamlandÄ±ÄŸÄ±nda Ã§alÄ±ÅŸacak fonksiyon
  reader.onload = function() {
    var ortak_anahtar="";
    var target_cache_public="";
    var mypublic_cache="";
    var myprivate_cache="";
    var rsa_mode = "2";
    // okunan veriyi JSON olarak parse et
    var ayarlar = JSON.parse(this.result);
    // ayarlarÄ± konsola yazdÄ±r
    var asdas1 = document.getElementById("target_public_key");
    var asdas2 = document.getElementById("bizim_public_keyimiz");
    var asdas3 = document.getElementById("bizim_private_keyimiz");
    var e = document.getElementById("rsamode"); // seÃ§im elementini bul
    var key = CryptoJS.SHA256(config_shield).toString(CryptoJS.enc.Hex);
    var iv = CryptoJS.MD5(config_shield).toString(CryptoJS.enc.Hex);
    try {
        target_cache_public = decrypt_1(key,iv,ayarlar.targetpublic);
        mypublic_cache = decrypt_1(key,iv,ayarlar.mypublic);
        myprivate_cache = decrypt_1(key,iv,ayarlar.myprivate);
        ortak_anahtar = decrypt_1(key,iv,ayarlar.ortak_anahtar);
        rsa_mode = decrypt_1(key,iv,ayarlar.rsa_mode);
    } catch (err) {
        // Error yakalama kodu
        alert("Error");
        dosya.value = "";
        return false;
    }
    asdas1.value = target_cache_public;
    asdas2.value = mypublic_cache;
    asdas3.value = myprivate_cache;
    changeText_JS(rsa_mode);
    var asdas = document.getElementById("config_shield");
    asdas.value = "";
    if(ortak_anahtar != "" && ortak_anahtar != null){
        var asdasx = document.getElementById("ortak");
        asdasx.value = ortak_anahtar;
    }
    dosya.value = "";
    alert("Process completed");
  };
  // dosyayÄ± okumaya baÅŸla
  reader.readAsText(secilenDosya);
});
var encryptfile = document.getElementById("encryptfile");
encryptfile.addEventListener("change", function() {

  // seÃ§ilen ilk encryptfile al
  var secilenencryptfile = this.files[0];
  // FileReader nesnesi oluÅŸtur
  var reader = new FileReader();
  reader.onload = function() {
    var textarea = document.getElementById("arkadasinin_sifreli_mesaji");
    textarea.value = this.result;
    encryptfile.value = "";
};
  // encryptfile okumaya baÅŸla
  reader.readAsText(secilenencryptfile);
});
var decryptfile = document.getElementById("decryptfile");
decryptfile.addEventListener("change", function() {

  // seÃ§ilen ilk decryptfile al
  var secilendecryptfile = this.files[0];
  // FileReader nesnesi oluÅŸtur
  var reader = new FileReader();
  reader.onload = function() {
    var textarea = document.getElementById("sifrelenecek_rsa_mesaji");
    textarea.value = this.result;
    decryptfile.value = "";
};
  // decryptfile okumaya baÅŸla
  reader.readAsText(secilendecryptfile);
});
function passchange(){
    var ortak_anahtar = document.getElementById("ortak").value;
        if(ortak_anahtar == "" || ortak_anahtar == null){
            alert("Eski Symmetric Key Required");
            return;
        }
    var cipher = new SilverCipherMini(ortak_anahtar);
    var ortak_anahtarnew = document.getElementById("passchange").value;
        if(ortak_anahtarnew == "" || ortak_anahtarnew == null){
            alert("Yeni Symmetric Key Required");
            return;
        }
    var ciphernew = new SilverCipherMini(ortak_anahtarnew);
    var asdas1 = document.getElementById("target_public_key");
    var asdas2 = document.getElementById("bizim_public_keyimiz");
    var asdas3 = document.getElementById("bizim_private_keyimiz");
    var asdas4 = document.getElementById("ortak");
    var asdas5 = document.getElementById("passchange");
    var target_public_key = cipher.Decrypt(document.getElementById("target_public_key").value.trim());
    var bizim_public_keyimiz = cipher.Decrypt(document.getElementById("bizim_public_keyimiz").value.trim());
    var bizim_private_keyimiz = cipher.Decrypt(document.getElementById("bizim_private_keyimiz").value.trim());
    asdas1.value = ciphernew.Encrypt(target_public_key);
    asdas2.value = ciphernew.Encrypt(bizim_public_keyimiz);
    asdas3.value = ciphernew.Encrypt(bizim_private_keyimiz);
    asdas4.value = ortak_anahtarnew;
    asdas5.value = "";
    alert("Process completed");
}
</script>
<!--END SCRIPTS-->





        </div>
    </body>
</html>