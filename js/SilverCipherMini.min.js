class SilverCipherMini{constructor(t){this.hex_characters="abcdef0123456789",this.base64_characters="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789/+",this.hex_1="549e30c67ba2f81d",this.sg="C1C2C3C4E1324412",this.hXc="0201110202211102",this.hth_1="61fa2bed734890c5",this.rot13_1="4pvFr92x0jUfXHYomGO73LKID1lEaPNgdC6T5i8hBqSsnRy/eWuc+tJwQZbVAzkM",this.rot13_2="wvnk0qN7MJpITosEUf8LhXzm91tYyC4eDAx2brOlHVgFK6u/Wc5Pia+SjRZQdGB3",this.rot13_3="h/T2I5EbOmzxDHMBt603VA+a7GYcqJ9KQgUNZCWrRdveyswfSLun1F8pokPi4lXj",this.rot13_4="JuEnkzSo2lMcXadLf5trjs486R3h7+pNZWHixUPq9CQw0gOvFeDVGy/1YbTBmKIA",this.hash0="Lp2P/9DC+w7FeRto6nmOzjbcEQrTMhUZGiyS1f8xJaWYHNX3klsu0KAIVvB4qg5d",this.hash1="752IFzi6SPaXrQsNYtwERHLUZCTO9xjmJclq1KuAknW0VD4gMbBGyv38/fehpo+d",this.hash2="4zhwZkgPMG87lHRAaXK5uv0SFT9ycI6nEem/NJiVf2qY+jQsUWbtxo3LpDrOCBd1",this.hash3="p4k90jRq786irMIoCUWnu+EeZaOhtyXgAL2dw51VQvmbG3HYJSfPxDNFsKzB/lcT",this.hash4="HtigypvlBqSa94zkD5rPEUXMRY/LjdOJ+euVFoZn1h63GfINmWQKbTCxw782sc0A",this.hash5="fEUAHgGCpodPNWh7w4v+/kc6OrmbKVSzy0tj8M32La5RiIlqXeJQ9xsZu1TFYBnD",this.hash6="mTA4ONzeudspRMXQxbPLV5hi+gWG12Y/qDIrl3BUtjH9fo0vwSK67c8ykZnFCEJa",this.hash7="EN4+2QLUPqthmj/KGaRJvkdln6SAwObpVeI30szDyCiW7u8fxgZc9BTHYX1rM5Fo",this.hash8="opAR3+ScPdLJaOeVQmhN4BF9rKM267/wkyGXTUYDnxHvjZ8itqECu0bIgszlf5W1",this.hash9="mVgZR0GHbx+OeskhAv2yLBW1fY5Fjl4EudnMiP/pTJ6NqX8a93SoDQ7IrtcwUCKz",this.hasha="VOW3Mg7vdUx5rhYQFcz2jKotE0uP9lNy4I1mnpsqaLiCAB6J+R8GZTefXwbkDS/H",this.hashb="08TjDklwrCpAgH7GsU3QIvBaROZEM+o/fni1XFLVyxYhPzW629t4JKmSuNbd5eqc",this.hashc="D1396NatCpQydIhzMnlFvYS/iLu7eAG8BbOxqoUVX5+rjH2EWRKP4TmgwZsfc0Jk",this.hashd="3QjE5SfU+Y1MVbIy0a6Zm8hKoO4e2tcnFdR9uXrpWJGCxlAsvBT/kzDwiNgqP7LH",this.hashe="hRa4QoBy5blILAusSC/YFXKr6qpfP9c2N13TUvtZJxGWw0e+DOM7z8idVjgHEmkn",this.hashf="fX+0wuaDgj4U8GKBHPF17ATq3vpm9SVICkoY/RJxMeOZiQbLsdn2WNhtyrl5z6cE",null==t?this.key="123456789":this.key=t}base64_encode(t){var h,r,e,s="";for(h=0;h<t.length;h+=3)for(r=0,e=t[h]<<16|t[h+1]<<8|t[h+2];r<4;r+=1)8*h+6*r<=8*t.length?s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e>>18-6*r&63):s+="==";return s.replace(/=*$/,"")}base64_decode(t){let h=[],r=0,e=0,s=0;for(let i=0;i<t.length;i++){let n=t.charCodeAt(i),a=n>64&&n<91?n-65:n>96&&n<123?n-71:n>47&&n<58?n+4:43===n?62:47===n?63:-1;-1!==a&&(e=e<<6|a,(r+=6)>=8&&(h[s++]=e>>r-8&255,r-=8))}return new Uint8Array(h)}adler32(t){let h=1,r=0;for(let e=0;e<t.length;e++)r=(r+(h=(h+t.charCodeAt(e))%65521))%65521;return(r<<16|h).toString(16).padStart(8,"0")}uint8ArrayToString(t){return new TextDecoder().decode(t)}StringTouint8Array(t){return new TextEncoder().encode(t)}hex2bin(t){var h=t.length/2,r=new Uint8Array(h);for(let e=0;e<h;++e)r[e]=parseInt(t.substr(2*e,2),16);return r}bin2hex(t){let h="";for(let r=0;r<t.length;r++)h+=t[r].toString(16).padStart(2,"0");return h}Encrypt(t){console.log(t.length);let h=this.key,r=this.settingsgenerator(this.adler32(h).toString(CryptoJS.enc.Hex)),e=t.match(/.{1,256}/g),s="",i="";var n=CryptoJS.SHA512(h).toString(CryptoJS.enc.Hex);return e.forEach(t=>{i=this.Enc(t,n,r),n=CryptoJS.SHA512(n+i[1]).toString(CryptoJS.enc.Hex),s=s+i[0]+":"}),s=s.substring(0,s.length-1)}Decrypt(t){let h=this.key,r=this.settingsgenerator(this.adler32(h).toString(CryptoJS.enc.Hex)),e=t.toString().split(":"),s="",i=e.length;var n="";h=CryptoJS.SHA512(h).toString(CryptoJS.enc.Hex);for(var a=0;a<i;a++)n=this.Dec(e[a],h,r),h=CryptoJS.SHA512(h+n[1]).toString(CryptoJS.enc.Hex),s+=n[0];return s}Enc(t,h,r){let e=h;var s=t.match(/.{1,128}/g);let i="",n="";for(let a=0;a<s.length;a++){var o=this.FlushX(s[a],"e",h);h=CryptoJS.SHA512(h).toString(CryptoJS.enc.Hex),i+=o[0]+".",n+=o[1]}var c=n;return e=CryptoJS.SHA512(e).toString(CryptoJS.enc.Hex),[i=(i=this.E_death_round(i.slice(0,-1),r,e)).toString().split("").reverse().join(""),c]}Dec(t,h,r){var e=t.trim();e=e.toString().split("").reverse().join("");var s=CryptoJS.SHA512(h).toString(CryptoJS.enc.Hex),i=(e=this.D_death_round(e,r,s)).toString().split(".");e="";var n="";for(let a=0;a<i.length;a++){var o=this.FlushX(i[a],"d",h);h=CryptoJS.SHA512(h).toString(CryptoJS.enc.Hex),e+=o[0],n+=o[1],console.log("D-C0:"+o[0])}return[e,n]}FlushX(t,h,r){var e,s="",i=this.StringTouint8Array(r);r=CryptoJS.SHA512(r).toString(CryptoJS.enc.Hex);var n=this.hex2bin(r),a=this.hex2bin(this.E_hex_1(r)),o=this.XOREncrypt(n,a),c=this.hashtoXcode(r);if("e"==h){t=this.StringTouint8Array(t);var e=this.XOREncrypt(t,o);e=this.XOREncrypt(e,this.XOREncrypt(n,o)),e=this.bin2hex(e);for(var _=1;_<=10;_++)e=this.E_hex_1(e);console.log("E-HEX1B: "+e);var l=r,g=0,u="",$=e.toString().split(""),p="";Array.from($).forEach(function(t){128==g&&(g=0,l=r,r=CryptoJS.SHA512(r).toString(CryptoJS.enc.Hex),c=this.hashtoXcode(r.toString())),0==c[g]?(u=u+this.E_hex_1(t.toString())+l[g].toString(),p+=l[g]):1==c[g]?(u=u+l[g]+this.E_hex_1(t.toString()),p+=l[g]):2==c[g]&&(u=u+this.E_hex_1(t.toString())+this.hashtohash_1(l[g].toString()),p+=this.hashtohash_1(l[g].toString())),g++},this),console.log("EncC: "+u),console.log("EncH: "+p);var S=p,$="",f="";u=this.E_hex_1(u);var x=this.hex2bin(u);x=this.XOREncrypt(x,this.XOREncrypt(n,i)),x=this.XOREncrypt(x,n),E="",console.log("J START"+this.bin2hex(x)+"J END");var s=(E=this.base64_encode(x)).replace(/=/g,"")}else if("d"===h){u=t=t.trim(),e=this.base64_decode(u),e=this.XORDecrypt(e,n),e=this.XORDecrypt(e,this.XOREncrypt(n,i)),x=this.bin2hex(e),x=this.D_hex_1(x),$=[];for(let d=0;d<x.length;d+=2)$.push(x.substring(d,d+2));var u="",b="";g=0,c=this.hashtoXcode(r.toString());var A="";Array.from($).forEach(function(t){128===g&&(g=0,r=CryptoJS.SHA512(r).toString(CryptoJS.enc.Hex),c=this.hashtoXcode(r.toString())),0==c[g]||2==c[g]?(b=this.D_hex_1(t.substr(0,1)),p=t.substr(-1,1)):1==c[g]&&(b=this.D_hex_1(t.substr(-1,1)),p=t.substr(0,1).toString()),g++,u+=b,A+=p},this),S=A,$="",f="";for(let y=1;y<=10;y++)u=this.D_hex_1(u.toString());var E="";E=this.hex2bin(u),E=this.XORDecrypt(E,this.XOREncrypt(n,o)),""===(E=this.XORDecrypt(E,o))&&exit;var s=E=this.uint8ArrayToString(E)}return console.log("T1:"),console.log(s),[s,S]}encrypt_key(t,h){t=CryptoJS.MD5(t).toString(CryptoJS.enc.Hex);let r=0,e="",s,i,n="";for(s=0;s<=h.length-1;s++)32==r&&(r=0,t=CryptoJS.MD5(t).toString(CryptoJS.enc.Hex)),e+=i=this.Hash_Key(t.charAt(r),h.charAt(s)),r++;return e}decrypt_key(t,h){t=CryptoJS.MD5(t).toString(CryptoJS.enc.Hex);let r=0,e="",s,i,n="";for(s=0;s<=h.length-1;s++)32==r&&(r=0,t=CryptoJS.MD5(t).toString(CryptoJS.enc.Hex)),e+=i=this.Key_Hash(t.charAt(r),h.charAt(s)),r++;return e}bk_kb(t){let h="",r,e;for(r=0;r<=t.length-1;r++)t.charAt(r).toLowerCase()==t.charAt(r)&&(e="0"),t.charAt(r).toUpperCase()==t.charAt(r)&&(e="1"),"1"==e?h+=t.charAt(r).toLowerCase():"0"==e&&(h+=t.charAt(r).toUpperCase());return h}XOREncrypt(t,h){let r=new Uint8Array(t.byteLength);for(let e=0;e<t.byteLength;e++)r[e]=t[e]^h[e%h.length];return r}XORDecrypt(t,h){return this.XOREncrypt(t,h)}E_death_round(t,h,r){console.log("B64?"),console.log(t),t=t.toString().split("").reverse().join("");let e=h.trim().toString().split(""),s,i,n;for(i=0,n=t;i<=h.trim().length-1;i++)"E"==(s=e[i])&&(n=this.encrypt_key(r,n)),"1"==s&&(n=this.E_rot13_1(n)),"2"==s&&(n=this.E_rot13_2(n)),"3"==s&&(n=this.E_rot13_3(n)),"4"==s&&(n=this.E_rot13_4(n)),"C"==s&&(n=this.bk_kb(n));return this.encrypt_key(r,n)}D_death_round(t,h,r){let e,s,i;for(s=0,t=this.decrypt_key(r,t),e=h.toString().split("").reverse();s<=h.toString().split("").reverse().length-1;s++)"E"==(i=e[s])&&(t=this.decrypt_key(r,t)),"1"==i&&(t=this.D_rot13_1(t)),"2"==i&&(t=this.D_rot13_2(t)),"3"==i&&(t=this.D_rot13_3(t)),"4"==i&&(t=this.D_rot13_4(t)),"C"==i&&(t=this.bk_kb(t));return t=t.toString().split("").reverse().join("")}E_hex_1(t){return t.split("").map(function(t){return this.hex_1[this.hex_characters.indexOf(t)]},this).join("")}D_hex_1(t){return t.split("").map(function(t){return this.hex_characters[this.hex_1.indexOf(t)]},this).join("")}settingsgenerator(t){let h,r,e;return h=this.hex_characters,r=this.sg,e=t.toString().split("").map(function(t){return r[h.indexOf(t)]||t}).join("")}hashtoXcode(t){let h,r,e;return h=this.hex_characters,r=this.hXc,e=t.toString().split("").map(function(t){return r[h.indexOf(t)]||t}).join("")}hashtohash_1(t){let h,r,e;return h=this.hex_characters,r=this.hth_1,e=t.toString().split("").map(function(t){return r[h.indexOf(t)]||t}).join("")}E_rot13_1(t){let h=this.base64_characters,r=this.rot13_1,e=t.replace(/[A-Za-z0-9+/]/g,function(t){return r.charAt(h.indexOf(t))});return e}D_rot13_1(t){let h=this.rot13_1,r=this.base64_characters,e=t.replace(/[A-Za-z0-9+/]/g,function(t){return r.charAt(h.indexOf(t))});return e}E_rot13_2(t){let h=this.base64_characters,r=this.rot13_2,e=t.replace(/[A-Za-z0-9+/]/g,function(t){return r.charAt(h.indexOf(t))});return e}D_rot13_2(t){let h=this.rot13_2,r=this.base64_characters,e=t.replace(/[A-Za-z0-9+/]/g,function(t){return r.charAt(h.indexOf(t))});return e}E_rot13_3(t){let h=this.base64_characters,r=this.rot13_3,e=t.replace(/[A-Za-z0-9+/]/g,function(t){return r.charAt(h.indexOf(t))});return e}D_rot13_3(t){let h=this.rot13_3,r=this.base64_characters,e=t.replace(/[A-Za-z0-9+/]/g,function(t){return r.charAt(h.indexOf(t))});return e}E_rot13_4(t){let h=this.base64_characters,r=this.rot13_4,e=t.replace(/[A-Za-z0-9+/]/g,function(t){return r.charAt(h.indexOf(t))});return e}D_rot13_4(t){let h=this.rot13_4,r=this.base64_characters,e=t.replace(/[A-Za-z0-9+/]/g,function(t){return r.charAt(h.indexOf(t))});return e}Hash_Key(t,h){let r=this.base64_characters,e;"0"===t?e=this.hash0:"1"===t?e=this.hash1:"2"===t?e=this.hash2:"3"===t?e=this.hash3:"4"===t?e=this.hash4:"5"===t?e=this.hash5:"6"===t?e=this.hash6:"7"===t?e=this.hash7:"8"===t?e=this.hash8:"9"===t?e=this.hash9:"a"===t?e=this.hasha:"b"===t?e=this.hashb:"c"===t?e=this.hashc:"d"===t?e=this.hashd:"e"===t?e=this.hashe:"f"===t&&(e=this.hashf);let s=h.toString().split("").map(t=>{let h=r.indexOf(t);return -1!==h?e[h]:t}).join("");return s}Key_Hash(t,h){let r;"0"===t?r=this.hash0:"1"===t?r=this.hash1:"2"===t?r=this.hash2:"3"===t?r=this.hash3:"4"===t?r=this.hash4:"5"===t?r=this.hash5:"6"===t?r=this.hash6:"7"===t?r=this.hash7:"8"===t?r=this.hash8:"9"===t?r=this.hash9:"a"===t?r=this.hasha:"b"===t?r=this.hashb:"c"===t?r=this.hashc:"d"===t?r=this.hashd:"e"===t?r=this.hashe:"f"===t&&(r=this.hashf);let e=this.base64_characters,s=h.toString().split("").map(t=>{let h=r.indexOf(t);return -1!==h?e[h]:t}).join("");return s}}